2025-02-09 11:10:39,112 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
Found class: CurrentPosition
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,112 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: stock
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,112 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: str
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,112 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: avg_price_bought
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,112 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: float
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,112 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: current_price
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,112 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: float
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,112 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: quantity
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,112 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: float
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,112 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: stop_limit
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,112 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: float
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,112 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: stop_limit_in_place
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,112 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: int
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,112 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: strategy
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,112 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: str
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Fields: {'stock': 'str', 'avg_price_bought': 'float', 'current_price': 'float', 'quantity': 'float', 'stop_limit': 'float', 'stop_limit_in_place': 'int', 'strategy': 'str'}
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
Found class: TargetPosition
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: stock
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: str
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: avg_price_bought
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: float
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: current_price
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: float
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: quantity
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: float
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: stop_limit
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: float
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: strategy
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: str
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Fields: {'stock': 'str', 'avg_price_bought': 'float', 'current_price': 'float', 'quantity': 'float', 'stop_limit': 'float', 'strategy': 'str'}
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
Found class: OpenOrders
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: order_id
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: int
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: stock
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: str
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: time
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: datetime.datetime
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: price_transacted
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: float
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: fees
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: float
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: quantity
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: float
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: strategy
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: str
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Fields: {'order_id': 'int', 'stock': 'str', 'time': 'datetime.datetime', 'price_transacted': 'float', 'fees': 'float', 'quantity': 'float', 'strategy': 'str'}
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
Found class: Transaction
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: stock
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: str
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: time
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: datetime.datetime
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: price_transacted
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,113 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: float
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: fees
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: float
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: quantity
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: float
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: strategy
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: str
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Fields: {'stock': 'str', 'time': 'datetime.datetime', 'price_transacted': 'float', 'fees': 'float', 'quantity': 'float', 'strategy': 'str'}
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
Found class: HistoricalData
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: stock
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: str
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: time
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: datetime.datetime
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: open
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: float
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: high
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: float
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: low
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: float
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: close
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: float
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: volume
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: int
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Processing field: close_reg_20
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
    Field type: float
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,114 - models_types_generator - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
  Fields: {'stock': 'str', 'time': 'datetime.datetime', 'open': 'float', 'high': 'float', 'low': 'float', 'close': 'float', 'volume': 'int', 'close_reg_20': 'float'}
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,118 - init_db() - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
Database initialization complete.
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:10:39,121 - IBC - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
IBC LOGS START
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:11:03,561 - IBC - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
IBC LOGS END - IBKR started
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:11:04,258 - IBAsyncBroker - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
connect(): Successfully connected to IBKR.
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:11:10,346 - IBAsyncBroker - ERROR - 
[31m------------------------------------------------------------------------------------------------------------------------------------
reqMktData() in get_current_price() timed out - no data for ticker: SPY
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:11:10,495 - run.py - ERROR - 
[31m------------------------------------------------------------------------------------------------------------------------------------
Failed, Disconnecting from brokers now: Traceback (most recent call last):
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlite3.IntegrityError: NOT NULL constraint failed: target_positions.avg_price_bought

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/app/run.py", line 16, in run
    await asyncio.gather(*[daily_run_using(strategy['broker'], strategy['strategy']) for strategy in atomic_strategies])
  File "/Users/ryantan/.pyenv/versions/3.10.0/lib/python3.10/asyncio/tasks.py", line 304, in __wakeup
    future.result()
  File "/Users/ryantan/.pyenv/versions/3.10.0/lib/python3.10/asyncio/tasks.py", line 232, in __step
    result = coro.send(None)
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/app/create_app.py", line 35, in daily_run_using
    target_positions = await update_target_positions_from_strategies(ibkr, strategies)
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/app/tasks/daily_tasks.py", line 51, in update_target_positions_from_strategies
    target_position.create_or_update_all(target_positions)
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/app/services/models/BaseCRUD.py", line 232, in create_or_update_all
    self.session.commit()
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4353, in flush
    self._flush(objects)
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4488, in _flush
    with util.safe_reraise():
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4449, in _flush
    flush_context.execute()
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/ryantan/Downloads/Personal Projects/auto ibkr/py_book/backend/venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 942, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) NOT NULL constraint failed: target_positions.avg_price_bought
[SQL: UPDATE target_positions SET avg_price_bought=?, current_price=?, stop_limit=? WHERE target_positions.stock = ? AND target_positions.strategy = ?]
[parameters: (nan, nan, nan, 'SPY', 'LinReg')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:11:10,496 - IBAsyncBroker - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
disconnect(): Successfully disconnected from IBKR.
------------------------------------------------------------------------------------------------------------------------------------[0m
2025-02-09 11:11:10,498 - send_command_to_ibc() - INFO - 
[32m------------------------------------------------------------------------------------------------------------------------------------
Response: OK Shutting down: STOP command

------------------------------------------------------------------------------------------------------------------------------------[0m
